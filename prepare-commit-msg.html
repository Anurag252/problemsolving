	<p>#!/bin/sh
#
	<ol>
		<li>An example hook script to prepare the commit log message.</li>
		<li>Called by &#8220;git commit&#8221; with the name of the file that has the</li>
		<li>commit message, followed by the description of the commit</li>
		<li>message&#8217;s source.  The hook&#8217;s purpose is to edit the commit</li>
		<li>message file.  If the hook fails with a non-zero status,</li>
		<li>the commit is aborted.</li>
	</ol>
#
	<ol>
		<li>To enable this hook, rename this file to &#8220;prepare-commit-msg&#8221;.</li>
	</ol></p>

	<ol>
		<li>This hook includes three examples. The first one removes the</li>
		<li>&#8221;# Please enter the commit message&#8230;&#8221; help message.</li>
	</ol>
#
	<ol>
		<li>The second includes the output of &#8220;git diff &#8212;name-status -r&#8221;</li>
		<li>into the message, just before the &#8220;git status&#8221; output.  It is</li>
		<li>commented because it doesn&#8217;t cope with &#8212;amend or with squashed</li>
		<li>commits.</li>
	</ol>
#
	<ol>
		<li>The third example adds a Signed-off-by line to the message, that can</li>
		<li>still be edited.  This is rarely a good idea.</li>
	</ol>

	<p><span class="caps">COMMIT</span>_MSG_FILE=$1<br />
COMMIT_SOURCE=$2<br />
SHA1=$3</p>

	<p>/usr/bin/perl -i.bak -ne &#8216;print unless(m/^. Please enter the commit message/..m/^#$/)&#8217; &#8220;$COMMIT_MSG_FILE&#8221;</p>

	<ol>
		<li>case &#8220;$COMMIT_SOURCE,$SHA1&#8221; in</li>
		<li>,|template,)</li>
		<li>/usr/bin/perl -i.bak -pe &#8216;</li>
		<li>print &#8220;\n&#8221; . `git diff &#8212;cached &#8212;name-status -r`</li>
		<li>if /^#/ &&amp; $first++ == 0&#8217; &#8220;$COMMIT_MSG_FILE&#8221; ;;</li>
		<li>*) ;;</li>
		<li>esac</li>
	</ol>

	<ol>
		<li>SOB=$(git var GIT_COMMITTER_IDENT | sed -n &#8216;s/^\(.*>\).*$/Signed-off-by: \1/p&#8217;)</li>
		<li>git interpret-trailers &#8212;in-place &#8212;trailer &#8220;$SOB&#8221; &#8220;$COMMIT_MSG_FILE&#8221;</li>
		<li>if test -z &#8220;$COMMIT_SOURCE&#8221;</li>
		<li>then</li>
		<li>/usr/bin/perl -i.bak -pe &#8216;print &#8220;\n&#8221; if !$first_line++&#8217; &#8220;$COMMIT_MSG_FILE&#8221;</li>
		<li>fi</li>
	</ol>