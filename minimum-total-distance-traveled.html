	<p>class Solution:
    def minimumTotalDistance(
        self, robot: List[int], factory: List[List[int]]
    ) -&gt; int:
        robot.sort()
        factory.sort(key=lambda x: x<sup class="footnote" id="fnreve650b4486f20418f89d59ec1dcc76461-1"><a href="#fne650b4486f20418f89d59ec1dcc76461-1">0</a></sup>)
        factory_positions = []
        for f in factory:
            factory_positions.extend([f<sup class="footnote"><a href="#fne650b4486f20418f89d59ec1dcc76461-1">0</a></sup>] * f<sup class="footnote" id="fnreve650b4486f20418f89d59ec1dcc76461-2"><a href="#fne650b4486f20418f89d59ec1dcc76461-2">1</a></sup>)
        robot_count = len(robot)
        factory_count = len(factory_positions)</p>

        dp = [[None] * (factory_count + 1) for _ in range(robot_count + 1)]

        def _calculate_min_distance(robot_idx: int, factory_idx: int) -&gt; int:
            if dp[robot_idx][factory_idx] is not None:
                return dp[robot_idx][factory_idx]
            if robot_idx  robot_count:
                dp[robot_idx][factory_idx] = 0
                return 0
            if factory_idx  factory_count:
                dp[robot_idx][factory_idx] = int(1e12)
                return int(1e12)

            assign = abs(
                robot[robot_idx] &#8211; factory_positions[factory_idx]
            ) + _calculate_min_distance(robot_idx + 1, factory_idx + 1)

            skip = _calculate_min_distance(robot_idx, factory_idx + 1)

            dp[robot_idx][factory_idx] = min(assign, skip)
            return dp[robot_idx][factory_idx]

        return _calculate_min_distance(0, 0)